<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Optimizer - History Clear Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #1e1e2e;
            color: #E0E0E0;
        }
        .test-section {
            background: #2a2a3e;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #444;
        }
        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .test-button:hover {
            background: #5a6de8;
        }
        .test-result {
            background: #1a1a2e;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            border-left: 4px solid #667eea;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success { border-left-color: #10b981; color: #10b981; }
        .error { border-left-color: #ef4444; color: #ef4444; }
        .warning { border-left-color: #f59e0b; color: #f59e0b; }
    </style>
</head>
<body>
    <h1>ğŸ§ª Prompt Optimizer - History Clear Test</h1>
    
    <div class="test-section">
        <h2>GeÃ§miÅŸ Temizleme Testi</h2>
        <p>Bu sayfa eklentinin geÃ§miÅŸ temizleme fonksiyonunu test etmek iÃ§in kullanÄ±lÄ±r. Popup'ta "Temizle" dÃ¼ÄŸmesine bastÄ±ÄŸÄ±nÄ±zda geÃ§miÅŸin hemen temizlenip temizlenmediÄŸini kontrol edin.</p>
        
        <button class="test-button" onclick="addTestData()">Test Verisi Ekle</button>
        <button class="test-button" onclick="checkHistory()">GeÃ§miÅŸi Kontrol Et</button>
        <button class="test-button" onclick="clearTestResults()">SonuÃ§larÄ± Temizle</button>
        
        <div id="testResults"></div>
    </div>

    <div class="test-section">
        <h2>Test AdÄ±mlarÄ±</h2>
        <ol>
            <li><strong>Test Verisi Ekle</strong> dÃ¼ÄŸmesine basarak test verisi oluÅŸturun</li>
            <li><strong>GeÃ§miÅŸi Kontrol Et</strong> dÃ¼ÄŸmesine basarak geÃ§miÅŸte veri olduÄŸunu doÄŸrulayÄ±n</li>
            <li>Eklenti popup'Ä±nÄ± aÃ§Ä±n (eklenti ikonuna tÄ±klayÄ±n)</li>
            <li>Popup'ta <strong>"Temizle"</strong> dÃ¼ÄŸmesine basÄ±n</li>
            <li>Bu sayfada tekrar <strong>GeÃ§miÅŸi Kontrol Et</strong> dÃ¼ÄŸmesine basÄ±n</li>
            <li>GeÃ§miÅŸin hemen temizlendiÄŸini gÃ¶rÃ¼n</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>â˜• Kahve Linki Testi</h2>
        <p>Header'daki kahve ikonunun Buy Me a Coffee linkine yÃ¶nlendirip yÃ¶nlendirmediÄŸini test edin.</p>
        
        <button class="test-button" onclick="testCoffeeLink()">Kahve Linkini Test Et</button>
        
        <div id="coffeeLinkResults"></div>
    </div>

    <div class="test-section">
        <h2>Ayarlar SayfasÄ± Testi</h2>
        <p>Ayarlar sayfasÄ±nÄ±n doÄŸru Ã§alÄ±ÅŸÄ±p Ã§alÄ±ÅŸmadÄ±ÄŸÄ±nÄ± test edin.</p>
        
        <button class="test-button" onclick="openSettingsPage()">Ayarlar SayfasÄ±nÄ± AÃ§</button>
        <button class="test-button" onclick="testSettingsFeatures()">Ayarlar Ã–zelliklerini Test Et</button>
        
        <div id="settingsTestResults"></div>
    </div>

    <div class="test-section">
        <h2>Metin SeÃ§imi Testi</h2>
        <p>Bu metni seÃ§erek eklentinin optimize fonksiyonunu test edebilirsiniz. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
        
        <p><strong>Test iÃ§in:</strong> YukarÄ±daki metni seÃ§in, saÄŸ tÄ±klayÄ±n ve "Prompt Ä°yileÅŸtir" seÃ§eneklerinden birini seÃ§in. ArdÄ±ndan popup'ta geÃ§miÅŸi kontrol edin ve temizleme iÅŸlemini test edin.</p>
    </div>

    <script>
        let testResultCounter = 0;

        function addTestResult(message, type = 'info') {
            const resultsDiv = document.getElementById('testResults');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            resultsDiv.appendChild(resultDiv);
        }

        async function addTestData() {
            try {
                const response = await chrome.runtime.sendMessage({
                    action: 'saveToHistory',
                    original: `Test orijinal prompt ${++testResultCounter}`,
                    optimized: `Test optimize edilmiÅŸ prompt ${testResultCounter}`,
                    options: { tone: 'neutral', length: 'maintain' }
                });
                
                if (response && response.success) {
                    addTestResult(`Test verisi ${testResultCounter} baÅŸarÄ±yla eklendi.`, 'success');
                } else {
                    addTestResult('Test verisi eklenemedi.', 'error');
                }
            } catch (error) {
                addTestResult(`Hata: ${error.message}`, 'error');
            }
        }

        async function checkHistory() {
            try {
                const response = await chrome.runtime.sendMessage({
                    action: 'getHistory'
                });
                
                if (response && response.success) {
                    const count = response.data ? response.data.length : 0;
                    addTestResult(`GeÃ§miÅŸte ${count} kayÄ±t bulundu.`, count > 0 ? 'success' : 'warning');
                    
                    if (count > 0) {
                        const lastItem = response.data[0];
                        addTestResult(`Son kayÄ±t: "${lastItem.original}" -> "${lastItem.optimized}"`, 'info');
                    }
                } else {
                    addTestResult('GeÃ§miÅŸ alÄ±namadÄ±.', 'error');
                }
            } catch (error) {
                addTestResult(`Hata: ${error.message}`, 'error');
            }
        }

        function clearTestResults() {
            document.getElementById('testResults').innerHTML = '';
            testResultCounter = 0;
            addTestResult('Test sonuÃ§larÄ± temizlendi.', 'info');
        }

        function openSettingsPage() {
            try {
                chrome.tabs.create({
                    url: chrome.runtime.getURL('src/settings.html')
                });
                addTestResult('Ayarlar sayfasÄ± aÃ§Ä±ldÄ±.', 'success');
            } catch (error) {
                addTestResult(`Ayarlar sayfasÄ± aÃ§Ä±lamadÄ±: ${error.message}`, 'error');
            }
        }

        function testCoffeeLink() {
            try {
                chrome.tabs.create({
                    url: 'https://buymeacoffee.com/osmntahir'
                });
                addTestResult('â˜• Buy Me a Coffee sayfasÄ± aÃ§Ä±ldÄ±!', 'success');
            } catch (error) {
                addTestResult(`Kahve linki aÃ§Ä±lamadÄ±: ${error.message}`, 'error');
            }
        }

        async function testSettingsFeatures() {
            addTestResult('Ayarlar Ã¶zellikleri test ediliyor...', 'info');
            
            // Test settings save
            try {
                await chrome.storage.sync.set({ 
                    userPreferences: { 
                        defaultTone: 'casual',
                        saveHistory: true,
                        maxHistory: 15 
                    } 
                });
                addTestResult('Test ayarlarÄ± kaydedildi (ton: samimi).', 'success');
                
                // Test settings load
                const result = await chrome.storage.sync.get(['userPreferences']);
                if (result.userPreferences) {
                    addTestResult(`Ayarlar yÃ¼klendi: VarsayÄ±lan ton = ${result.userPreferences.defaultTone}`, 'success');
                } else {
                    addTestResult('Ayarlar yÃ¼klenemedi.', 'error');
                }
            } catch (error) {
                addTestResult(`Ayarlar test edilemedi: ${error.message}`, 'error');
            }
        }

        // Auto-check history on page load
        window.addEventListener('load', () => {
            addTestResult('Test sayfasÄ± yÃ¼klendi. Chrome extension API kontrol ediliyor...', 'info');
            
            if (typeof chrome !== 'undefined' && chrome.runtime) {
                addTestResult('Chrome extension API mevcut. Test iÅŸlemleri kullanÄ±labilir.', 'success');
                checkHistory();
            } else {
                addTestResult('Chrome extension API mevcut deÄŸil. Bu sayfayÄ± Chrome\'da eklenti yÃ¼klenmiÅŸ halde aÃ§Ä±n.', 'error');
            }
        });
    </script>
</body>
</html>